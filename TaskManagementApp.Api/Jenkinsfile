pipeline {
    agent any  // Runs the pipeline on any available agent

    environment {
        // You can set up environment variables like the path to the .NET SDK if needed
        DOTNET_HOME = 'C:\\Program Files\\dotnet'  // Adjust this if you're using a custom SDK location
        //PATH = "${DOTNET_HOME}\\bin:${env.PATH}"  // Add .NET to PATH
    }

    stages {
        stage('Checkout') {
            steps {
                echo 'Checking out code from Git repository...'
                checkout scm  // Checks out the repository code
            }
        }

        stage('Restore Dependencies') {
            steps {
                echo 'Restoring NuGet packages...'
                script {
                    // Runs dotnet restore for the solution
                    bat 'dotnet restore TaskManagementApp.sln'  // Replace TaskManagementApp.sln with your actual solution name
                }
            }
        }

        stage('Build') {
            steps {
                echo 'Building the solution...'
                script {
                    // Runs dotnet build to compile the solution in Release configuration
                    bat 'dotnet build TaskManagementApp.sln --configuration Release'  // Adjust the solution name if needed
                }
            }
        }

        stage('Run Tests') {
            steps {
                echo 'Running unit tests...'
                script {
                    // Runs dotnet test to execute unit tests
                    bat 'dotnet test TaskManagementApp.sln --configuration Release'  // Adjust the solution name if needed
                }
            }
        }
    }

    post {
        always {
            echo 'Cleaning up after build...'
            // You can add post-build steps like archiving build artifacts or sending notifications
        }
        success {
            echo 'Build succeeded!'
            // You can add success notifications (email, Slack, etc.)
        }
        failure {
            echo 'Build failed!'
            // You can add failure notifications (email, Slack, etc.)
        }
    }
}
